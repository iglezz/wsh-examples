NewFileFolderEx.js
Версия: 0.6.8 (2020.01.08)
Автор: iglezz (iglezz@gmail.com)

Создание файлов/каталогов с автоподбором имени (используя счётчик) и поддержкой подстановочных строк.



==========================
Параметры командной строки
==========================

/f,  /file    FILE      - создать новый файл
/d,  /folder  FOLDER    - создать новую папку

/nc                     - отключить использование счётчика

/ansi                   - кодировка для файла ANSI
/utf8                   - кодировка для файла UTF-8 BOM
/unicode                - кодировка для файла UTF-16 LE BOM
/utf16le                - кодировка для файла UTF-16 LE BOM
/utf16be                - кодировка для файла UTF-16 BE BOM

/e,  /exec    [COMMAND] - выполнить команду после создания файла/папки
/s,  /send    [SEND]    - передать последовательность нажатий клавиш после создания файла/папки

/t,  /test              - тестовый запуск без создания файла/папки
/q,  /quiet             - тихий режим, без вывода сообщений и диалогов
     /eng               - use English locale

Примечания:
* элемент в [квадратных скобках] необязательный и может отсутствовать.
* строки FILE, FOLDER, COMMAND, SEND, если они содержат пробелы, следует обрамлять в кавычки (/file "New file.txt" вместо /file New file.txt)



===================================
Описание формата строк в параметрах
===================================

--------------------
Строки FILE и FOLDER
--------------------

Могут содержать переменные среды и подстановочные строки.
Переменные среды (%TEMP%, %APPDATA% и т.д.) раскрываются перед обработкой подстановочных строк. (Список: https://ru.wikipedia.org/wiki/%D0%9F%D0%B5%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%BD%D0%B0%D1%8F_%D1%81%D1%80%D0%B5%D0%B4%D1%8B)
Подстановочные строки заключены в угловые скобки, первый символ определяет тип строки (<C>, <D>).

Подерживаемые подстановочные строки:

~~~~~~~~~~~
C - Счётчик
~~~~~~~~~~~
 
Имеет формат: <C[OPT:][STRING]>, где:

  OPT - строка, которая содержит настройки счётчика:
  
    целое число задаёт начальное значение счётчика.
  
  STRING - строка, в которой производятся следующие замены:
  
    ? - значение счётчика
    
При этом:
  1. количество знаков "?" устанавливает минимальную ширину строкового значения счётчика, дополненную нулями (?? = 01, 02, 03, ...);
  2. пустая строка STRING заменяется на "?" (<C> будет приведена к <С?>);
  3. непустая строка без "?" будет выведена только при использовании счётчика;
  4. если начальное значение счётчика установлено в нескольких подстановочных строках, то будет использоваться только последнее;
  5. если ни одна из подстановочных строк счётчика не содержит самого счётчика ("?"), то после имени файла будет добавлена строка счётчика по умолчанию, при этом двойные расширения (.tar.gz) не поддерживаются.

Значения по умолчанию:
  1. в начальном имени файла/папки счётчик не выводится - он добавляется только если начальное имя занято;
  2. счётчик увеличивается на 1 при каждой попытке подобрать свободное имя файла;
  2. по умолчанию начальное значение счётчика - "2".

Примеры:
  "NewFile<C (?)>.txt" сформирует имя NewFile.txt, NewFile (2).txt, ...
  "NewFile<C1:>.txt" сформирует имя NewFile1.txt, NewFile2.txt, ...
  "NewFile<C_>.txt" эквивалентно "NewFile<C_?>.txt" или "NewFile<C_><C>.txt" и сформирует имя NewFile.txt, NewFile_2.txt, NewFile_3.txt, ...

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
D - Текущая дата и время (на момент запуска программы)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Имеет формат: <D[OPT:][STRING]>, где:

  OPT - строка, которая содержит настройки:
  
    "+"  - задаёт преобразование в ВЕРХНИЙ РЕГИСТР.
    "-"  - задаёт преобразование в нижний регистр.
    "en" - устанавливает английский язык.
    "ru" - устанавливает русский.

  STRING - строка, в которой производятся следующие замены:
  
    YYYY - год (2019, 2020)
    YY   - год, последние две цифры (19, 20)
    MMMM - месяц, полное название (January, February, ...)
    MMM  - месяц, краткое название (Jab, Feb, Mar, ...)
    MM   - месяц, двузначный номер (01, 02, ...)
    M    - месяц (1, 2, ...)
    DDD  - день с суффиксом (1st, 2nd, ... , 26th, ...) 
    DD   - день, двузначное число (01, 02, ...)
    D    - день
    WWWW - день недели, полное название (Monday, Tuesday, ...)
    WWW  - день недели, трёхбуквенное сокращение (Mon, Tue, ...)
    WW   - день недели, двухбуквенное сокращение (Mo, Tu, ...)
    W    - день недели, понедельник первый (1, 2, ...)
    WS   - день недели, воскресенье первое (1, 2, ...)
    hh   - час, двузначное число (01, 02, ...)
    h    - час (1, 2, ...)
    mm   - минуты, двузначное число (01, 02, ...)
    m    - минуты (1, 2, ...)
    ss   - секунды, двузначное число (01, 02, ...)
    s    - секунды (1, 2, ...)


--------------
Строка COMMAND
--------------

Имеет формат: "[!][[OPT]*][EXEC][:][PARAMS]", где:  

  "!"     - безусловное выполнение команды (независимо от успешности создания файла/папки)

  OPT     - строка, которая содержит настройки:
  
    q{CHAR}  - символ {CHAR} будет заменён в строке PARAMS на двойную кавычку
    
    m{NUM}   - число {NUM} заменяет режим выполнения программы/команды на:
    
      0 - Open the application with a hidden window.
      1 - Open the application with a normal window. If the window is minimized or maximized, the system restores it to its original size and position.
      2 - Open the application with a minimized window.
      3 - Open the application with a maximized window.
      4 - Open the application with its window at its most recent size and position. The active window remains active.
      5 - Open the application with its window at its current size and position.
      7 - Open the application with a minimized window. The active window remains active.

  EXEC    - выполняемая программа или команда, при этом:

    1. если EXEC начинается с символа "=", то оставшаяся часть трактуется как действие (open, edit, print, explore), сопоставленное для типа создаваемого файла/папки в реестре ("=open" -- команда open).
    2. если EXEC - пуста я строка или содержит только символ "=", то команда трактуется как действие по умолчанию для сопоставленного типа файла/папки.
    3. в остальных случаях EXEC - выполняемая программа (автоматически обрамляется в кавычки при необходимости).

  PARAMS  - параметры, передаваемые выполняемой команде, где производятся следующие замены:
  
    ?   - имя создаваемого файла/папки.

При этом:
  2. пустая строка PARAMS заменяется на "?";
  3. если PARAMS содержит только "?", то имя созданного файла/папки автоматически обрамляется в кавычки при необходимости;
  3. чтобы просто запустить программу без параметров, строку PARAMS следует составить из пробелов, т.е. /exec "watcher.exe: " запустит программу watcher.exe без параметров.


-----------
Строка SEND
-----------

Имеет формат: "[!][[OPT]*][TITLE:]KEYS", где:

  "!"   - отправка последовательности нажатий клавиш независимо от успешности создания файла/папки

  OPT     - строка, которая содержит настройки:

    d{NUM}  - число {NUM} - задержка перед отправкой последовательности нажатий клавиш в миллисекундах
    
    a       - последовательность нажатий клавиш будет отправлена в текущее активное окно, не использовать TITLE
    
  TITLE   - автивировать окно программы с заголовком окна TITLE (допускается частичное совпадение)

  KEYS  - последовательность нажатий клавиш. Подробности по ссылке: https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/windows-scripting/8c6yea83%28v%3dvs.84%29

  модификатор:        код:
  
  Shift               +
  Ctrl                ^
  Alt                 %
  
  клавиша:            код:
  
  +                   {+}
  ^                   {^}
  %                   {%}
  ~                   {~}
  {                   {{}
  }                   {}}
  
  ENTER               {ENTER} или ~
  TAB                 {TAB}
  BACKSPACE           {BACKSPACE} или {BS} или {BKSP}
  DEL или DELETE      {DEL} или {DELETE}
  INS или INSERT      {INS} или {INSERT}
  UP ARROW            {UP}
  DOWN ARROW          {DOWN}
  LEFT ARROW          {LEFT}
  RIGHT ARROW         {RIGHT}
  PAGE UP             {PGUP}
  PAGE DOWN           {PGDN}
  HOME                {HOME}
  END                 {END}
  BREAK               {BREAK}
  ESC                 {ESC}
  CAPS LOCK           {CAPSLOCK}
  NUM LOCK            {NUMLOCK}
  SCROLL LOCK         {SCROLLLOCK}
  PRINT SCREEN        {PRTSC}
  HELP                {HELP}
  F1                  {F1}
  F2                  {F2}
  F3                  {F3}
  F4                  {F4}
  F5                  {F5}
  F6                  {F6}
  F7                  {F7}
  F8                  {F8}
  F9                  {F9}
  F10                 {F10}
  F11                 {F11}
  F12                 {F12}
  F13                 {F13}
  F14                 {F14}
  F15                 {F15}
  F16                 {F16}
  
  Примеры:
  клавиши/строка:     код:
  Ctrl + A            ^A
  2+2 Enter           2{+}2{ENTER}
  2+2 Enter           2{+}2~
  HELLO               +(hello) 
  Hello               +hello



======================
Параметры по умолчанию
======================

Настраиваются в теле скрипта, объект var Config = {}



=====================
Возвращаемые значения
=====================

0 - успешное создание файла/папки. 
1 - ошибки в параметрах.
2 - имя файла/папки пустое или не задано.
3 - файл/папка с таким именем уже существует (при использовании ключа /nc).
4 - ошибка создания папки в пути к файлу/папке
5 - ошибка создания файла
6 - ошибка создания папки 
>20 - (внутренняя ошибка) 

=======
Примеры 
=======

/file newfile.txt /exec "notepad.exe" 
/file table.csv /exec "="
/file "new file.txt" /exec "!notepad3.exe:~/c ~?~" 
/folder %APPDATA%\SomeApp /exec "=explore"
/file "Log.txt" /utf8
/file "diary_<DYYYY.MM.DD>.txt" /nc /q /exec !